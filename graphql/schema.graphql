scalar Time

enum RoleType {
  SELLER
  BUYER
}

# Define the directive
directive @hasRole(role: RoleType!) on FIELD_DEFINITION

interface BaseInfo {
    id: String!
    email: String!
    first_name: String!
    last_name: String!
    phone: String!
    address: String!
}

type RefreshToken {
    token: String!
    refresh_token: String!
}

type AccountBuyer implements BaseInfo {
    token: String
    orders: [Order!]!

    id: String!
    email: String!
    first_name: String!
    last_name: String!
    phone: String!
    address: String!
}

type AccountSeller implements BaseInfo {
    token: String
    store_name: String!
    products: [Product!]!

    id: String!
    email: String!
    first_name: String!
    last_name: String!
    phone: String!
    address: String!
}

type Product {
    id: String!
    name: String!
    description: String!
    price: Float!
    quantity: Int!

    seller_id: String!
}

type OrderProduct {
    product: Product!
    quantity: Int!
}

type Order {
    id: String!
    account: AccountBuyer!
    products: [OrderProduct!]!
    total_price: Float!
    created_at: Time!
    address: String!
}

input PaginationInput {
    skip: Int!
    take: Int!
}

input BaseInfoInput {
    email: String
    first_name: String!
    last_name: String!
    phone: String!
    address: String!
}

input AccountSellerInput {
    store_name: String!
    base_info: BaseInfoInput!
}

input AccountBuyerInput {
    base_info: BaseInfoInput!
}

input ProductInput {
    seller_id: String!
    name: String!
    description: String!
    price: Float!
    quantity: Int!
}

input OrderProductInput {
    product_id: String!
    quantity: Int!
}

input OrderInput {
    account_id: String!
    products: [OrderProductInput!]!
    address: String!
}

union LoginResult = AccountBuyer | AccountSeller

type Mutation {
    createAccountSeller(account: AccountSellerInput!): AccountSeller! @hasRole(role: SELLER)
    updateAccountSeller(account: AccountSellerInput!, id: String!): AccountSeller! @hasRole(role: SELLER)

    createAccountBuyer(account: AccountBuyerInput!): AccountBuyer! @hasRole(role: BUYER)
    updateAccountBuyer(account: AccountBuyerInput!, id: String!): AccountBuyer! @hasRole(role: BUYER)

    createUser(email: String!, password: String!, role: RoleType!): String!
    loginUser(email: String!, password: String!): LoginResult!
    refrehToken(token: String!): RefreshToken!

    createProduct(product: ProductInput!): Product! @hasRole(role: SELLER)
    updateProduct(product: ProductInput!, id: String!): Product! @hasRole(role: SELLER)
    deleteProduct(id: String!): String! @hasRole(role: SELLER)

    createOrder(order: OrderInput!): Order!
    deleteOrder(id: String!): String!
}

type Query {
    buyer(id: String!): AccountBuyer!
    seller(id: String!): AccountSeller!
    sellers(pagination: PaginationInput, id:[String!]): [AccountSeller!]!
    products(pagination: PaginationInput, query: String, id: String): [Product!]!
    orders(id: String): [Order!]!
}

